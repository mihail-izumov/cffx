<template>
  <div class="signal-demo-wrapper">
    <!-- Tesla-style переключатель: Общепит /Фитнес -->
    <div class="signal-theme-toggle">
      <button
        class="signal-theme-btn"
        :class="{ active: selectedTheme === 'cafe' }"
        @click="selectedTheme = 'cafe'"
      >
        Общепит
      </button>
      <button
        class="signal-theme-btn"
        :class="{ active: selectedTheme === 'fitness' }"
        @click="selectedTheme = 'fitness'"
      >
        Фитнес
      </button>
      <div class="signal-theme-slider" :style="{ left: sliderLeft }"></div>
    </div>

    <!-- Переключатель: Эмоции / Факты / Решение -->
    <div class="signal-demo__header">
      <div class="signal-demo__switch" role="tablist">
        <button
          v-for="section in sections"
          :key="section.id"
          class="signal-demo__switch-btn"
          :class="[isActive(section.id) ? 'is-active' : '', section.id]"
          type="button"
          role="tab"
          :aria-selected="isActive(section.id)"
          @click="selectedSection = section.id"
        >
          {{ section.title }}
        </button>
      </div>
    </div>

    <!-- ГЛАВНЫЙ КОНТЕНТ — НА ВСЮ ШИРИНУ -->
    <div class="signal-form-content">
      <!-- Эмоции -->
      <div v-if="selectedSection === 'emotions'" class="signal-question-block" :style="{ '--accent-color': colors.emotions }">
        <p class="signal-direction-label">Эмоции и чувства</p>
        <div class="signal-rotating-phrase-container">
          <transition name="fade" mode="out-in">
            <p :key="currentQuestion1" class="signal-question-label">{{ currentQuestion1 }}</p>
          </transition>
        </div>
        <textarea
          v-model="form.emotionalRelease"
          @focus="startRotation(1)"
          rows="3"
          :placeholder="placeholders.emotions"
          required>
        </textarea>
        <div class="signal-suggestions-container">
          <div
            v-for="suggestion in currentSuggestions.emotions"
            :key="suggestion"
            class="signal-suggestion-bubble signal-emotion-bubble"
            @click="selectSuggestion('emotionalRelease', suggestion, 'emotions')"
          >
            {{ suggestion }}
          </div>
          <div
            v-if="showResetButton('emotions')"
            class="signal-suggestion-bubble signal-reset-bubble signal-emotion-bubble"
            @click="resetSuggestions('emotions')"
          >
            ← Ещё варианты
          </div>
        </div>
        <p class="signal-example-hint" v-html="examples.emotions"></p>
      </div>

      <!-- Факты -->
      <div v-if="selectedSection === 'facts'" class="signal-question-block" :style="{ '--accent-color': colors.facts }">
        <p class="signal-direction-label">Детали проблемы</p>
        <div class="signal-rotating-phrase-container">
          <transition name="fade" mode="out-in">
            <p :key="currentQuestion2" class="signal-question-label">{{ currentQuestion2 }}</p>
          </transition>
        </div>
        <textarea
          v-model="form.factualAnalysis"
          @focus="startRotation(2)"
          rows="3"
          :placeholder="placeholders.facts"
          required>
        </textarea>
        <div class="signal-suggestions-container">
          <div
            v-for="suggestion in currentSuggestions.facts"
            :key="suggestion"
            class="signal-suggestion-bubble signal-fact-bubble"
            @click="selectSuggestion('factualAnalysis', suggestion, 'facts')"
          >
            {{ suggestion }}
          </div>
          <div
            v-if="showResetButton('facts')"
            class="signal-suggestion-bubble signal-reset-bubble signal-fact-bubble"
            @click="resetSuggestions('facts')"
          >
            ← Ещё варианты
          </div>
        </div>
        <p class="signal-example-hint" v-html="examples.facts"></p>
      </div>

      <!-- Решение -->
      <div v-if="selectedSection === 'solutions'" class="signal-question-block" :style="{ '--accent-color': colors.solutions }">
        <p class="signal-direction-label">Предложение решения</p>
        <div class="signal-rotating-phrase-container">
          <transition name="fade" mode="out-in">
            <p :key="currentQuestion3" class="signal-question-label">{{ currentQuestion3 }}</p>
          </transition>
        </div>
        <textarea
          v-model="form.constructiveSuggestions"
          @focus="startRotation(3)"
          rows="3"
          :placeholder="placeholders.solutions"
          required>
        </textarea>
        <div class="signal-suggestions-container">
          <div
            v-for="suggestion in currentSuggestions.solutions"
            :key="suggestion"
            class="signal-suggestion-bubble signal-solution-bubble"
            @click="selectSuggestion('constructiveSuggestions', suggestion, 'solutions')"
          >
            {{ suggestion }}
          </div>
          <div
            v-if="showResetButton('solutions')"
            class="signal-suggestion-bubble signal-reset-bubble signal-solution-bubble"
            @click="resetSuggestions('solutions')"
          >
            ← Ещё варианты
          </div>
        </div>
        <p class="signal-example-hint" v-html="examples.solutions"></p>
      </div>
    </div>
  </div>
</template>

<script setup>
import { reactive, ref, computed, watch, onUnmounted } from 'vue';

// === Режимы ===
const selectedTheme = ref('cafe'); // 'cafe' | 'fitness'

// === Секции ===
const sections = [
  { id: 'emotions', title: 'Эмоции' },
  { id: 'facts', title: 'Факты' },
  { id: 'solutions', title: 'Решение' }
];
const selectedSection = ref('emotions');
const isActive = (id) => id === selectedSection.value;

// === Конфиги (БЕЗ suggestions) ===
const configs = {
  cafe: {
    colors: { emotions: '#A972FF', facts: '#3DDC84', solutions: '#FFB800' },
    placeholders: {
      emotions: 'Или напишите своими словами ...',
      facts: 'Несколько фактов: что и когда произошло ...',
      solutions: 'Дайте честный совет ...'
    },
    examples: {
      emotions: 'Пример: «Кофе был <b>холодный</b>, а бариста <b>не обратил внимания</b>»',
      facts: 'Пример: «Заказ на два капучино <b>ждал 22 минуты</b>, хотя в кафе был почти один»',
      solutions: 'Пример: «Добавить на кассе <b>таймер</b>, чтобы бариста видел <b>время ожидания</b>»'
    },
    questions: {
      1: ['Что вы почувствовали?', 'Какие эмоции испытали?', 'Что расстроило?', 'Что порадовало?'],
      2: ['Что именно произошло?', 'Какие детали важны?', 'Опишите факты'],
      3: ['Что можно сделать лучше?', 'Как исправить?', 'Ваши предложения?']
    },
    suggestions: {
  emotions: {
    initial: ['довольна', 'восхищена', 'благодарна', 'спокойна', 'удивлена', 'расстроена', 'разочарована', 'недовольна', 'возмущена'],

    'довольна': ['чистотой', 'сервисом', 'качеством', 'атмосферой', 'вниманием'],
    'восхищена': ['профессионализмом', 'дизайном', 'скоростью', 'вкусом', 'подходом'],
    'благодарна': ['за внимание', 'за компенсацию', 'за помощь', 'за улыбку', 'за рекомендацию'],
    'спокойна': ['всё стандартно', 'нет проблем', 'привычно', 'ничего не раздражает', 'всё ровно'],
    'удивлена': ['таким сервисом', 'быстротой', 'качеством', 'вниманием', 'ценой'],
    'расстроена': ['долго ждала', 'грязная посуда', 'холодный кофе', 'грубый персонал', 'забыли заказ'],
    'разочарована': ['качеством', 'сервисом', 'ожиданиями', 'атмосферой', 'чистотой'],
    'недовольна': ['обслуживанием', 'очередью', 'ошибкой в заказе', 'температурой блюд', 'упаковкой'],
    'возмущена': ['антисанитарией', 'хамством', 'обманом', 'некачественной едой', 'инородными предметами'],

    // Уровень 2
    'чистотой': ['грязные столы', 'липкий пол', 'немытая посуда', 'пыль везде', 'антисанитария'],
    'сервисом': ['медленный', 'невнимательный', 'равнодушный', 'непрофессиональный', 'хаотичный'],
    'качеством': ['хуже чем обычно', 'не соответствует цене', 'испортилось за месяц', 'как в фастфуде', 'совсем не то'],
    'атмосферой': ['шумно и грязно', 'неуютно', 'холодно', 'плохая музыка', 'неприятные запахи'],
    'вниманием': ['не поздоровались', 'игнорировали', 'не спросили', 'не проверили', 'не улыбнулись'],

    'профессионализмом': ['бариста знает кофе', 'официант помнит заказ', 'повара на высоте', 'все чётко', 'видно опыт'],
    'дизайном': ['красивые чашки', 'стильные столики', 'приятный свет', 'декор', 'интерьер'],
    'скоростью': ['кофе за 3 минуты', 'заказ через 5 мин', 'не ждала', 'быстро принесли', 'оперативно'],
    'вкусом': ['идеальный латте', 'вкусный десерт', 'свежая выпечка', 'отличный соус', 'вкусно как дома'],
    'подходом': ['индивидуально', 'понимают клиента', 'гибкие', 'идут навстречу', 'чуткие'],

    'за внимание': ['спросили как дела', 'пожелали хорошего дня', 'улыбнулись', 'поблагодарили', 'запомнили имя'],
    'за компенсацию': ['вернули деньги', 'дали десерт', 'скидку', 'новый кофе', 'извинились'],
    'за помощь': ['помогли с выбором', 'подсказали', 'объяснили', 'рекомендовали', 'показали'],
    'за улыбку': ['искренне', 'тепло', 'дружелюбно', 'заразительно', 'радушно'],
    'за рекомендацию': ['что взять', 'новое меню', 'сезонное', 'по вкусу', 'по диете'],

    'всё стандартно': ['ничего выдающегося', 'как всегда', 'нормально', 'без сюрпризов', 'привычно'],
    'нет проблем': ['всё гладко', 'без задержек', 'работает', 'ничего не ломалось', 'всё по плану'],
    'привычно': ['как в прошлый раз', 'знакомый вкус', 'тот же сервис', 'ничего нового', 'стабильно'],
    'ничего не раздражает': ['тихо', 'чисто', 'вежливо', 'комфортно', 'спокойно'],
    'всё ровно': ['без эмоций', 'средне', 'нормально', 'ни хорошо ни плохо', 'стандарт'],

    'таким сервисом': ['впервые такое', 'не ожидала', 'шокирована', 'не верю', 'ужасно'],
    'быстротой': ['меньше 5 минут', 'мгновенно', 'рекорд', 'не успела сесть', 'супер'],
    'качеством': ['на высоте', 'идеально', 'свежее', 'вкусно', 'как в рекламе'],
    'вниманием': ['запомнили заказ', 'спросили имя', 'пожелали дня', 'поблагодарили', 'улыбнулись'],
    'ценой': ['дешевле чем думала', 'акция', 'выгодно', 'приятный сюрприз', 'не дорого'],

    'долго ждала': ['20 минут', '30 минут', 'более часа', 'без объяснений', 'видя пустую кофейню'],
    'грязная посуда': ['следы помады', 'остатки еды', 'жирные пятна', 'засохший кофе', 'странный запах'],
    'холодный кофе': ['едва тёплый', 'совсем остыл', 'подали холодным', 'остыл пока ждала', 'температура комнатная'],
    'грубый персонал': ['не поздоровались', 'хамили', 'игнорировали', 'были раздражены', 'повысили голос'],
    'забыли заказ': ['через 40 минут', 'не записали', 'потеряли чек', 'не передали на кухню', 'сидела и ждала'],

    'обслуживанием': ['долгое ожидание', 'путаница в заказах', 'невежливость', 'игнорирование', 'ошибки кассира'],
    'очередью': ['не двигалась', 'час стояла', 'нет системы', 'хаос', 'всех пропускают'],
    'ошибкой в заказе': ['не тот напиток', 'забыли позицию', 'неправильный размер', 'другой сироп', 'перепутали'],
    'температурой блюд': ['холодные', 'остывшие', 'чуть тёплые', 'не разогрели', 'ледяные'],
    'упаковкой': ['протекающие крышки', 'слабые пакеты', 'разорвалась', 'неудобная', 'грязная'],

    'антисанитарией': ['грязные руки', 'упал и подали', 'на полу готовят', 'мухи', 'тараканы'],
    'хамством': ['нагрубили', 'оскорбили', 'накричали', 'показали характер', 'послали'],
    'обманом': ['не тот объем', 'обвесили', 'скрыли стоимость', 'навязали', 'обсчитали'],
    'некачественной едой': ['испорченная', 'несвежая', 'странный вкус', 'горькая', 'кислая'],
    'инородными предметами': ['волосы в еде', 'пластик в круассане', 'проволока', 'нитки', 'жук'],

    // Уровень 3
    'грязные столы': ['крошки', 'жир', 'липко', 'не протирали', 'от предыдущих гостей'],
    'липкий пол': ['от пролитого', 'не мыли', 'скользко', 'опасно', 'не убирали'],
    'немытая посуда': ['разводы', 'запах', 'остатки еды', 'не отмыли', 'грязные ложки'],
    'бариста знает кофе': ['рассказал про зерно', 'подобрал по вкусу', 'объяснил разницу', 'дал попробовать', 'эксперт'],
    'кофе за 3 минуты': ['с 14:10 до 14:13', 'быстро', 'не ждала', 'идеально', 'рекорд'],
    'спросили как дела': ['по-настоящему', 'улыбнулись', 'запомнили имя', 'пожелали дня', 'тепло'],
    'меньше 5 минут': ['4:30 по таймеру', 'быстрее всех', 'не успела сесть', 'впечатляет', 'рекорд'],
    '20 минут': ['засекала по телефону', 'с 14:00 до 14:20', 'другие ушли', 'кофейня пустая', 'без объяснений'],
    'следы помады': ['на чашке', 'красная', 'от предыдущей', 'не помыли', 'противно'],
    'едва тёплый': ['40 градусов', 'можно пить сразу', 'не обжигает', 'остыл', 'не по стандарту'],
    'не поздоровались': ['прошли мимо', 'не посмотрели', 'игнор', 'не улыбнулись', 'холодно'],
    'через 40 минут': ['с 12:00 до 12:40', 'подходила дважды', 'не извинились', 'потеряли заказ', 'ужас'],
    'волосы в еде': ['длинный чёрный', 'в салате', 'на булочке', 'в супе', 'противно'],
    'пластик в круассане': ['твёрдый кусок', 'чуть не сломала зуб', 'опасно', 'не проверили', 'жалоба']
  },

  facts: {
    initial: ['ожидание', 'ошибка в заказе', 'качество блюд', 'чистота', 'персонал'],

    'ожидание': ['20 минут', '30 минут', 'более часа', 'забыли заказ', 'очередь не двигалась'],
    'ошибка в заказе': ['не тот напиток', 'не доложили позицию', 'неправильный соус', 'перепутали объём', 'другое молоко'],
    'качество блюд': ['холодный кофе', 'невкусная еда', 'чёрствая выпечка', 'комочки в матче'],
    'чистота': ['грязная посуда', 'волосы в еде', 'грязная уборная', 'насекомые', 'пластик в круассане'],
    'персонал': ['грубость', 'невнимательность', 'некомпетентность', 'трогали еду руками', 'не извинились'],

    // Уровень 2
    '20 минут': ['засекала по часам', 'спросила у соседнего стола', 'заказала в 14:30, получила в 14:50', 'долгое ожидание для простого заказа', 'других обслужили быстрее'],
    '30 минут': ['полчаса точно', 'с 15:00 до 15:30', 'дважды подходила узнать', 'время на телефоне показало', 'успела прочитать новости'],
    'более часа': ['час и 10 минут', 'полтора часа ждала', 'с 12:00 до 13:15', 'весь обед потратила', 'опоздала на встречу'],
    'забыли заказ': ['не записали', 'потеряли чек', 'не передали на кухню', 'перепутали с другим', 'готовила не то'],
    'очередь не двигалась': ['стояла полчаса', 'один кассир на всех', 'касса сломалась', 'менялись местами', 'хаос'],

    'не тот напиток': ['заказала латте, принесли капучино', 'просила без сахара, был сладкий', 'хотела большой, дали маленький', 'другой сироп добавили', 'обычное молоко вместо овсяного'],
    'не доложили позицию': ['забыли десерт', 'нет половины заказа', 'пропали сэндвичи', 'только кофе принесли', 'блинчики не было'],
    'неправильный соус': ['положили не тот соус к тыквенным панкейкам', 'острый вместо сладкого', 'майонез вместо сметаны', 'кетчуп забыли', 'соус отдельно не дали'],
    'перепутали объём': ['несоответствие объема напитков', 'маленький вместо большого', 'дали меньше чем заказала', 'размер не тот', 'обманули с порцией'],
    'другое молоко': ['обычное вместо овсяного', 'соевое вместо миндального', 'с лактозой дали', 'не предупредили', 'аллергия может быть'],

    'холодный кофе': ['градусов 40-50', 'можно было пить сразу', 'не обжигал язык', 'как будто стоял долго', 'температура комнатная'],
    'невкусная еда': ['пересоленная', 'недосоленная', 'горькая', 'кислая', 'странный вкус'],
    'чёрствая выпечка': ['как камень', 'вчерашняя', 'сухая', 'твёрдая', 'невозможно откусить'],
    'комочки в матче': ['комочки в матче', 'не размешали', 'порошок не растворился', 'комки муки', 'неоднородная масса'],

    'грязная посуда': ['на чашке помада', 'жирные разводы на тарелке', 'крошки от предыдущих гостей', 'капли кофе на блюдце', 'следы от губной помады'],
    'волосы в еде': ['чёрный волос в редисе', 'длинный волос в салате', 'волосы на булочке', 'в супе волос', 'противно есть'],
    'грязная уборная': ['не убирали', 'бумаги нет', 'воняет', 'лужи на полу', 'грязь везде'],
    'насекомые': ['тараканы бегают', 'муха в кофе', 'жук в салате', 'паук на стене', 'противно смотреть'],
    'пластик в круассане': ['кусочек пластика в круассане', 'твёрдый кусок', 'чуть не сломала зуб', 'опасно', 'могла подавиться'],

    'грубость': ['не поздоровались', 'ответили резко', 'закатили глаза', 'проигнорировали вопрос', 'были явно недовольны'],
    'невнимательность': ['не слушали', 'переспрашивали', 'отвлекались', 'забыли просьбу', 'записали неправильно'],
    'некомпетентность': ['не знали меню', 'не умели готовить', 'путались в кнопках', 'долго соображали', 'спрашивали у коллег'],
    'трогали еду руками': ['трогали трубочку грязными руками', 'лапали булочки', 'без перчаток', 'грязными руками', 'неаккуратно'],
    'не извинились': ['даже не извинились', 'было все равно', 'сделали вид что нормально', 'проигнорировали', 'сказали что так и надо'],

    // Уровень 3
    'засекала по часам': ['телефон показал', 'скриншот', 'видео', 'свидетели', 'точно 20 минут'],
    'заказала в 14:30, получила в 14:50': ['чек с временем', 'фото чека', 'другие видели', 'не торопились', 'кофейня пустая'],
    'не записали': ['устно сказала', 'не повторили', 'не внесли в систему', 'потеряли', 'не передали'],
    'заказала латте, принесли капучино': ['просила без пены', 'принесли с пеной', 'другой вкус', 'не то', 'ошибка'],
    'градусов 40-50': ['измерила термометром', 'едва тёплый', 'не по ГОСТу', 'не обжигает', 'остыл'],
    'на чашке помада': ['красная', 'от предыдущей', 'не помыли', 'противно', 'жалоба'],
    'чёрный волос в редисе': ['длинный', 'в салате', 'не мой', 'не заметили', 'антисанитария'],
    'не поздоровались': ['прошли мимо', 'не посмотрели', 'игнор', 'холодно', 'невежливо']
  },

  solutions: {
    initial: ['таймер ожидания', 'обучение персонала', 'контроль качества', 'система проверки', 'стандарты сервиса'],

    'таймер ожидания': ['визуальный контроль бариста/старшего бариста', 'с номерами заказов', 'видимый гостям', 'контроль времени', 'сигналы на баре', 'обратная связь от гостей'],
    'обучение персонала': ['по сервису', 'по санитарии', 'по качеству', 'по коммуникации', 'регулярные тренинги'],
    'контроль качества': ['проверка блюд', 'температурный контроль', 'свежесть продуктов', 'упаковка', 'дегустация'],
    'система проверки': ['чек-лист качества', 'двойная проверка', 'контроль чистоты', 'стандарты подачи', 'фото блюд'],
    'стандарты сервиса': ['вежливость', 'скорость', 'точность', 'чистота', 'профессионализм'],

    // Уровень 2
    'визуальный контроль бариста/старшего бариста': ['песочные часы на стойке', 'отчёты по среднему времени заказа', 'замеры скорости обслуживания менеджером', 'сравнение с нормой', 'обсуждение на пятиминутке'],
    'с номерами заказов': ['в мобильном приложении', 'на чеке QR-код', 'на чеке номер заказа'],
    'видимый гостям': ['в мобильном приложении', 'на чеке QR-код', 'на чеке номер заказа'],
    'контроль времени': ['стандарт 7 минут', 'красная зона после 10 мин', 'автоотсчёт от момента пробития чека'],
    'сигналы на баре': ['цветовые индикаторы готовности', 'звуковой таймер для бариста'],
    'обратная связь от гостей': ['опрос о времени ожидания', 'кнопка "долго жду" в приложении', 'комментарий в чеке QR-кодом'],

    'по сервису': ['тренинги вежливости', 'ролевые игры', 'работа с жалобами', 'стандарты общения', 'мотивация персонала'],
    'по санитарии': ['мытье посуды', 'уборка столов', 'проверка чистоты', 'гигиена рук', 'контроль температуры'],
    'по качеству': ['дегустация напитков', 'проверка ингредиентов', 'температура подачи', 'внешний вид блюд', 'сроки годности'],
    'по коммуникации': ['активное слушание', 'решение конфликтов', 'извинения и компенсации', 'позитивное общение', 'работа с негативом'],
    'регулярные тренинги': ['раз в месяц', 'новых сотрудников', 'переаттестация', 'мастер-классы', 'обмен опытом'],

    'проверка блюд': ['перед подачей', 'температура напитков', 'внешний вид', 'соответствие заказу', 'свежесть ингредиентов'],
    'температурный контроль': ['термометр для кофе', '85-90 градусов', 'горячие блюда', 'холодные напитки', 'контроль каждый час'],
    'свежесть продуктов': ['ежедневная поставка', 'сроки годности', 'ротация товара', 'маркировка даты', 'утилизация просрочки'],
    'упаковка': ['герметичные крышки', 'качественные пакеты', 'стаканы не протекают', 'салфетки в комплекте', 'удобная переноска'],
    'дегустация': ['каждая партия', 'новые рецепты', 'мнение гостей', 'тестирование вкуса', 'корректировка рецептур'],

    'чек-лист качества': ['для каждого заказа', 'проверка температуры', 'чистота посуды', 'правильность состава', 'время подачи'],
    'двойная проверка': ['готовящая и подающая', 'кассир и бариста', 'менеджер и персонал', 'фото готового блюда', 'подпись ответственной'],
    'контроль чистоты': ['каждый час', 'чек-лист уборки', 'дезинфекция', 'мытье рук', 'чистая форма'],
    'стандарты подачи': ['правильная посуда', 'украшение блюд', 'салфетки и приборы', 'температура подачи', 'презентация'],
    'фото блюд': ['перед подачей', 'контроль качества', 'обучение персонала', 'соцсети', 'архив образцов'],

    'вежливость': ['приветствие с улыбкой', 'благодарность гостье', 'извинения за ошибки', 'помощь в выборе', 'прощание'],
    'скорость': ['стандарт 10 минут', 'быстрое принятие заказа', 'оперативная готовка', 'мгновенная подача', 'ускоренная оплата'],
    'точность': ['записывать заказы', 'повторять вслух', 'проверять чек', 'уточнять детали', 'контроль состава'],
    'чистота': ['мытье рук каждые 30 мин', 'чистая форма', 'дезинфекция поверхностей', 'порядок на рабочем месте', 'свежая посуда'],
    'профессионализм': ['знание меню', 'умение готовить', 'решение проблем', 'работа в команде', 'развитие навыков'],

    // Уровень 3
    'песочные часы на стойке': ['3 минуты', 'видно всем', 'дисциплина', 'контроль', 'прозрачно'],
    'стандарт 7 минут': ['от пробития чека', 'до подачи', 'норма', 'KPI', 'мониторинг'],
    'термометр для кофе': ['цифровой', 'точность 0.1°', 'проверка каждой чашки', 'стандарт 85-90°', 'обучение'],
    'ежедневная поставка': ['утром', 'свежие продукты', 'проверка при приёмке', 'контроль сроков', 'надёжный поставщик'],
    'приветствие с улыбкой': ['обязательно', 'искренне', 'по имени', 'пожелание дня', 'стандарт'],
    'записывать заказы': ['в блокнот', 'в планшет', 'повторять вслух', 'уточнять', 'без ошибок']
  }
}
  },
  fitness: {
    colors: { emotions: '#A972FF', facts: '#3DDC84', solutions: '#FFB800' },
    placeholders: {
      emotions: 'Или напишите своими словами ...',
      facts: 'Несколько фактов: что и когда произошло ...',
      solutions: 'Дайте честный совет ...'
    },
    examples: {
      emotions: 'Пример: «Тренажёр <b>сломан</b>, а администратор <b>не помог</b>»',
      facts: 'Пример: «Тренер опоздал на <b>15 минут</b>, группа ждала у двери»',
      solutions: 'Пример: «Поставить <b>таймер на двери</b>, чтобы опоздания были видны всем»'
    },
    questions: {
      1: ['Что вы почувствовали?', 'Какие эмоции испытали?', 'Что расстроило?', 'Что порадовало?'],
      2: ['Что именно произошло?', 'Какие детали важны?', 'Опишите факты'],
      3: ['Что можно сделать лучше?', 'Как исправить?', 'Ваши предложения?']
    },
    suggestions: {
  emotions: {
    initial: [
      'довольна', 'восхищена', 'благодарна', 'спокойна',
      'удивлена', 'расстроена', 'разочарована', 'недовольна', 'возмущена'
    ],

    // ----- Позитивные эмоции -----
    'довольна': [
      'чистотой клуба', 'отзывчивостью персонала', 'качеством оборудования', 'атмосферой пространства', 'гибким расписанием'
    ],
    'чистотой клуба': [
      'раздевалка пахнет свежо', 'уборка 2 раза в день', 'нет запаха', 'чистые зеркала', 'чистый душ'
    ],
    'раздевалка пахнет свежо': [
      'вентиляция работает', 'ароматизаторы сменяют запах', 'тест на запах корректорами', 'чистые полки', 'запах свежести после уборки'
    ],
    'уборка 2 раза в день': [
      'график уборки опубликован', 'отметка клинера в приложении', 'фотоотчёт после уборки', 'служба контроля проверяет факт', 'отличие до и после чистки'
    ],
    'нет запаха': [
      'смена фильтров каждый месяц', 'нет запаха пота', 'регулярная проверка воздуха', 'аромадиффузор включён ежедневно', 'очистка вентиляции'
    ],
    'чистые зеркала': [
      'микрофибра используется', 'нет пятен после группы', 'проверка сотрудником после каждой тренировки', 'отметка клиента в системе', 'отполированы уголки'
    ],
    'чистый душ': [
      'глубокая уборка раз в день', 'новые шторки каждый месяц', 'предоставлены гель и шампунь', 'отсутствие плесени', 'есть коврики после уборки'
    ],

    'отзывчивостью персонала': [
      'помогли с тренажёром', 'ответили в чате', 'запомнили имя', 'мотивируют новичков', 'решили спор быстро'
    ],
    'помогли с тренажёром': [
      'персональный инструктаж', 'показали все режимы', 'есть видео-инструкция', 'объяснили ошибки и силы', 'настроили под твою цель'
    ],
    'ответили в чате': [
      'оператор отвечает не позднее 10 минут', 'чат открыт с 08:00 до 22:00', 'есть база знаний', 'персональные советы в чате', 'сохранена история переписки'
    ],
    'запомнили имя': [
      'обращаются по имени при входе', 'поздравляют с днем рождения', 'отмечают прогресс в сообщениях', 'учёт ваших успехов ведёт тренер', 'индивидуальная рассылка уведомлений'
    ],
    'мотивируют новичков': [
      'приветственная тренировка для новых клиентов', 'подарок за первую тренировку', 'доска успеха новичков', 'мотивационное видео после первой недели', 'режим “мотиватор” в приложении'
    ],
    'решили спор быстро': [
      'оперативная реакция админа', 'в течение часа спор закрывался', 'применили компенсацию', 'заявка на поддержку не задержана', 'результат внесён в историю клиента'
    ],

    'качеством оборудования': [
      'новые тренажёры', 'датчики работают', 'удобная посадка', 'нет поломок', 'регулярно обслуживается'
    ],
    'новые тренажёры': [
      'модель 2025 года', 'сертификат производителя', 'отзывы клиентов подтверждены', 'есть гарантия 2 года', 'интеграция с мобильным приложением'
    ],
    'датчики работают': [
      'подключение к телефону без ошибок', 'замер пульса точный', 'сохраняется история тренировок', 'работают все функции', 'отображение на экране тренажёра'
    ],
    'удобная посадка': [
      'регулируется под рост', 'есть инструкция для разных пользователей', 'поддержка поясницы', 'плавная настройка кресла', 'анатомическая форма'
    ],
    'нет поломок': [
      'служба сервиса проверяет каждые выходные', 'ремонт занимает не более 1 дня', 'рассылка об исправлениях', 'отзыв о поломке отмечен', 'нет повторяющихся проблем'
    ],
    'регулярно обслуживается': [
      'замена расходников раз в месяц', 'осмотр сервисным инженером', 'история ТО сохраняется', 'рекомендации по уходу видны в профиле клиента', 'все оборудование сертифицировано'
    ],

    'атмосферой пространства': [
      'музыка приятная', 'нет резкого света', 'много зон отдыха', 'пол в хорошем состоянии', 'уютная обстановка'
    ],
    'музыка приятная': [
      'выбор стиля есть в приложении', 'разные зоны – разные треки', 'нет орущих динамиков', 'музыка снижает тревожность', 'выбор звука для групповой тренировки'
    ],
    'нет резкого света': [
      'LED-освещение с регулировкой', 'дневной свет через окна', 'без мигания ламп', 'зональное управление', 'естественный свет в раздевалке'
    ],
    'много зон отдыха': [
      'мягкие диваны', 'столы с розетками', 'бар с водой и снеками', 'Wi-Fi стабильный', 'можно отдохнуть в лобби'
    ],
    'пол в хорошем состоянии': [
      'антискользящее покрытие', 'нет луж и пролитий', 'регулярная мойка', 'запасные коврики', 'качественная плитка'
    ],
    'уютная обстановка': [
      'живые растения', 'теплые цвета', 'декор по сезону', 'фото-зона', 'приглушённый звук'
    ],

    'гибким расписанием': [
  'есть ночные группы', 'удобная запись', 'режим выходного дня', 'гибкая замена групп', 'онлайн-план занятий'
],
    ‘есть ночные группы’: [
      ‘тренировки в 21:00 и позже’, ‘расписание восточного тренинга’, ‘очный тренер ночью’, ‘клиенты отдыхают после работы’, ‘охрана и освещение ночью’
    ],
    ‘удобная запись’: [
      ‘календарь в приложении’, ‘смс-напоминание’, ‘возможность отмены без штрафа’, ‘история всех тренировок’, ‘гибкая система замены’
    ],
    ‘режим выходного дня’: [
      ‘занятия в субботу и воскресенье’, ‘особые группы воскресенья’, ‘тариф выходного дня ниже’, ‘регистрация утром до 7:00’, ‘вечерние мастер-классы’
    ],
    ‘гибкая замена групп’: [
      ‘резерв по телефону’, ‘быстрая замена в приложении’, ‘автоматический поиск свободного времени’, ‘возможность приглашать друзей’, ‘изменение расписания без штрафа’
    ],
    ‘онлайн-план занятий’: [
      ‘фильтрация по времени’, ‘автоматический подбор группы’, ‘мгновенное подтверждение’, ‘видна загруженность’, ‘отправка напоминаний’
    ],

    // Следующее сообщение — остальные позитивные + все негативные эмоции, тройная вложенность
  }
}
// ... (предыдущие блоки)

    'благодарна': [
      'за решение проблемы', 'за индивидуальный подход', 'за поддержку новичков', 'за внимательное отношение', 'за рекомендации по тренировкам'
    ],
    'за решение проблемы': [
      'вернули деньги', 'предоставили бесплатное занятие', 'назначили нового тренера', 'извинения от руководства', 'компенсация на абонемент'
    ],
    'вернули деньги': [
      'пополнили баланс', 'чек на телефон', 'снятие с карты', 'отметка в профиле клиента', 'компенсация бонусами'
    ],
    'предоставили бесплатное занятие': [
      'записан на ближайшую группу', 'уведомление персоналу', 'отметка "бесплатно" в расписании', 'контроль через приложение', 'приглашение друга'
    ],

    'за индивидуальный подход': [
      'создали личный план', 'подобрали тренера по уровню', 'учли ограничения по здоровью', 'изменили группу', 'дали доступ к архиву программы'
    ],
    'создали личный план': [
      'индивидуальная оценка', 'советы по питанию', 'регулярные корректировки', 'отчёт по результату', 'подбор упражнений по целям'
    ],
    'подобрали тренера по уровню': [
      'оценка прогресса', 'тест на физическую форму', 'репостивный ответ системы', 'отзыв на сайте клуба', 'замена в течение месяца'
    ],

    'за поддержку новичков': [
      'провели пробное занятие', 'экскурсия по залу', 'групповой инструктаж', 'чек-лист первых шагов', 'активная помощь на старте'
    ],
    'провели пробное занятие': [
      'без оплаты', 'инструктор только для новичков', 'консультация по целям', 'материалы в приложении', 'поддержка в чате новичков'
    ],
    'экскурсия по залу': [
      'показали все зоны', 'рассказали о правилах', 'знакомство с тренерами', 'демонстрация инвентаря', 'разъяснение ключевых функций'
    ],

    'за внимательное отношение': [
      'администратор помнил цели', 'тренер регулярно писал напоминания', 'дарили мотивационные подарки', 'отмечали достижения', 'учитывали смену расписания'
    ],
    'администратор помнил цели': [
      'личное сообщение с поздравлением', 'отметка прогресса', 'внесение корректировок', 'замечание по технике', 'индивидуальное время тренировки'
    ],
    'тренер регулярно писал напоминания': [
      'смс с мотивацией', 'еженедельный отчёт', 'рассылка по результатам', 'пожелание удачи перед занятием', 'анализ слабых мест'
    ],

    'за рекомендации по тренировкам': [
      'подобрали программу восстановления', 'посоветовали йогу', 'рекомендация лучшего питания', 'советы по выбору тренажёра', 'направление к врачу'
    ],
    'подобрали программу восстановления': [
      'чек-лист упражнений', 'консультация по растяжке', 'материалы по РПП', 'памятка по отдыху', ' встреча с нутрициологом'
    ],
    'посоветовали йогу': [
      'запись на занятие через приложение', 'инструктор с сертификатом', 'материалы для домашней практики', 'групповая поддержка', 'челлендж на месяц'
    ],

    // ----- Спокойна -----
    'спокойна': [
      'обычная тренировка', 'стандартный сервис', 'нет ярких впечатлений', 'привычная атмосфера', 'нет проблем'
    ],
    'обычная тренировка': [
      'всё прошло по расписанию', 'нагрузка стандартна', 'без изменений', 'группа знакомая', 'тренер привычный'
    ],
    'всё прошло по расписанию': [
      'начали вовремя', 'без отмен', 'все пришли', 'оборудование работало', 'расписание в приложении совпало'
    ],
    'нагрузка стандартна': [
      'без новых упражнений', 'уровень нагрузки прежний', 'тренер не менял план', 'группа не устала', 'результаты стабильны'
    ],

    'стандартный сервис': [
      'администратор работает корректно', 'оборудование привычно', 'занятие началось в норме', 'техподдержка есть', 'проблем не возникло'
    ],
    'администратор работает корректно': [
      'всё объяснил', 'разрешил вопросы', 'корректен по расписанию', 'не было задержек', 'ответил на жалобу'
    ],
    'оборудование привычно': [
      'все привычные тренажёры', 'никто не жаловался', 'работают как всегда', 'нет сбоев', 'все поддержаны в чистоте'
    ],

    // ----- Удивлена -----
    'удивлена': [
      'новыми услугами', 'изменениями в расписании', 'появлением новых тренажёров', 'нестандартным подходом тренера', 'быстрой реакцией персонала'
    ],
    'новыми услугами': [
      'появился массаж', 'запущена сауна', 'детский фитнес', 'коучинг по питанию', 'занятия на крыше'
    ],
    'появился массаж': [
      'запись через клубное приложение', 'сертифицированный массажист', 'комплимент клиентам', 'специальная цена', 'отзыв можно оставить в клубной базе'
    ],
    'запущена сауна': [
      'график в приложении', 'отдельная зона', 'раздевалка рядом', 'входит в тариф', 'доступ после тренировки'
    ],

    'изменениями в расписании': [
      'добавили утро', 'расширили вечер', 'новые интенсивы вечером', 'гибкое бронирование', 'ввод выходных групп'
    ],
    'добавили утро': [
      'тренировки для работающих', 'ранее открытие зала', 'кофе для участников', 'мотивация на старте дня', 'возможна отмена без штрафа'
    ],
    'новые интенсивы вечером': [
      'инструктор по кардизону', 'спецгруппы под проекты клуба', 'выбор интенсивности', 'дополнительные бонусы', 'тренировки для всех классов'
    ],

    // ----- Негативные эмоции -----
    'расстроена': [
      'переполненностью зала', 'грубостью тренера', 'грязными раздевалками', 'ощущением неловкости', 'затруднённым доступом к оборудованию'
    ],
    'переполненностью зала': [
      'нет свободных тренажёров', 'очередь на беговую', 'толпа на ковриках', 'мешают заниматься', 'группа слишком большая'
    ],
    'нет свободных тренажёров': [
      'ожидание 20 минут', 'отсутствие броней', 'тайм-слот нарушен', 'админ не регулирует', 'группы совмещены'
    ],

    ‘грубостью тренера’: [
      ‘грубо разговаривал’, ‘игнорировал форму’, ‘давал непрофессиональные советы’, ‘выделял только одного клиента’, ‘критиковал громко’
    ],
    ‘грубо разговаривал’: [
      ‘отвечал резко’, ‘не здоровался’, ‘оценивал личность’, ‘повышал голос’, ‘не комментировал успехи’
    ],

    ‘грязными раздевалками’: [
      ‘грязь в душе’, ‘разбросанные вещи’, ‘нет чистых ковриков’, ‘запах сырости’, ‘не выносят мусор’
    ],
    ‘грязь в душе’: [
      ‘нет уборки’, ‘скользко после воды’, ‘плесень на плитке’, ‘грязные шторки’, ‘нет мыла’
    ],

    ‘ощущением неловкости’: [
      ‘все смотрят’, ‘стеснение раздеться’, ‘нет шторок’, ‘нет зоны для уединения’, ‘другая гендерная группа’
    ],
    ‘все смотрят’: [
      ‘пристальные взгляды’, ‘комментарии’, ‘смех над новым клиентом’, ‘игнор новичков’, ‘нет отдельной раздевалки’
    ],

    ‘затруднённым доступом к оборудованию’: [
      ‘тренажёры всегда заняты’, ‘очередь в приложении не работает’, ‘нет альтернатив’, ‘таймеры не соблюдают’, ‘администратор не помогает’
    ],
    ‘тренажёры всегда заняты’: [
      ‘нет расписания’, ‘таймер не включён’, ‘группы перепутаны’, ‘нет менеджера’, ‘ожидание по 25 минут’
    ],

    'разочарована': [
      'подходом персонала', 'ожиданиями от клуба', 'уровнем тренировок', 'расписанием занятий', 'стоимостью абонемента'
    ],
    'подходом персонала': [
      'равнодушие', 'нет поддержки', 'не объяснили правила', 'невнимательный тренер', 'нет мотивации'
    ],
    'равнодушие': [
      'ответ через силу', 'избегают прямого общения', 'нет инициативы', 'отсутствие приветствия', 'нет желания помочь'
    ],
    'нет поддержки': [
      'не помогли новичку', 'отказ в консультации', 'не рассказали о клубе', 'нет поддержки на старте', 'равнодушие к вопросам'
    ],

    'ожиданиями от клуба': [
      'думала будет лучше', 'по отзывам выше', 'завышенная реклама', 'обещали дополнительные услуги', 'ожидала премиум'
    ],
    'думала будет лучше': [
      'на деле хуже', 'реклама не соответствует', 'понравились отзывы, а в реальности не так', 'не оправдало ожиданий', 'обещания не выполнены'
    ],
    'по отзывам выше': [
      'расходится с мнением клиентов', 'разница в уровне сервиса', 'понравился сайт, а реальность иная', 'обещали быстрый сервис', 'нет того, что было в описании'
    ],

    'уровнем тренировок': [
      'монотонные упражнения', 'нет прогресса', 'нет индивидуальной работы', 'тренер не мотивирует', 'однотипные группы'
    ],
    'монотонные упражнения': [
      'повторяют прошлые', 'нет новых методик', 'нет подборок под цель', 'скучный процесс', 'цикличная работа'
    ],
    'нет прогресса': [
      'стоит на месте по результату', 'нет отслеживания', 'тренер не отмечает успех', 'нет анализов нагрузки', 'одни и те же ошибки'
    ],

    'расписанием занятий': [
      'неудобное время', 'нет подходящей группы', 'занятия отменяют', 'группы переполнены', 'смена расписания без уведомления'
    ],
    'неудобное время': [
      'нет тренировок утром', 'вечером прошло всё', 'не успеваю на группу', 'нет записи на выходные', 'проблемы с календарем'
    ],
    'нет подходящей группы': [
      'группы для новичка переполнены', 'нет детского разделения', 'только одна секция', 'нет выбора времени', 'нельзя выбрать уровень'
    ],

    'стоимостью абонемента': [
      'дорого', 'скрытые доплаты', 'нет возврата денег', 'штраф за отмену', 'нет разовых тарифов'
    ],
    'дорого': [
      '5000 в месяц', 'нет скидки для постоянных', 'сравнение с другими клубами не в пользу', 'разовый абонемент дороже группового', 'тариф не меняется по акциям'
    ],
    'скрытые доплаты': [
      'доплата за тренажёр', 'не включено занятие с тренером', 'стоимость детской комнаты отдельно', 'нет расчёта абонемента по дням', 'плата за вход в раздевалку'
    ],

    'недовольна': [
      'оборудованием', 'очередью на тренажёры', 'ошибкой в абонементе', 'температурой в зале', 'чистотой душевых'
    ],
    'оборудованием': [
      'старое', 'часто ломается', 'нет новых моделей', 'скрипит', 'не хватает веса'
    ],
    'старое': [
      'дата выпуска не обновляется', 'нет Bluetooth', 'механика изношена', 'не соответствует фото на сайте', 'ржавчина на деталях'
    ],
    'часто ломается': [
      'нет запчастей', 'ожидание ремонта больше недели', 'нет сервиса на месте', 'запись на ремонт сложная', 'долго ждёшь новый тренажёр'
    ],

    'очередью на тренажёры': [
      'ждать приходится постоянно', 'таймер не работает', 'группы не разграничены', 'нет календаря в приложении', 'никакой очереди нет вовсе'
    ],
    'ждать приходится постоянно': [
      'по 15 минут на каждый подход', 'нет уведомлений', 'менеджер не контролирует загрузку', 'занято всегда вечером', 'скандалы между клиентами'
    ],
    'таймер не работает': [
      'не обновляется автоматически', 'нет напоминания', 'администратор не считает время', 'вручную все отмечают', 'ценность таймера потеряна'
    ],

    'ошибкой в абонементе': [
      'двойное списание', 'не приходит подтверждение', 'нет возврата', 'тариф заблокирован', 'нельзя внести изменения'
    ],
    'двойное списание': [
      'без уведомления смс', 'автоматическое продление', 'ошибка приложения', 'нет возврата средств', 'долго ждёшь решение'
    ],
    'не приходит подтверждение': [
      'молчание от клуба', 'нет чека', 'только ответ через неделю', 'админ уходит от ответа', 'неясно за что списали'
    ],

    'температурой в зале': [
      'жарко', 'холодно', 'душно', 'нет регулировки вентиляции', 'сквозняки в раздевалках'
    ],
    'жарко': [
      '30 градусов в кардио', 'вентилятор сломан', 'нет жалюзи', 'нет выбора температурного режима', 'админ не реагирует'
    ],
    'холодно': [
      'нет обогрева', 'открыты окна', 'зимние температуры и летом', 'нет тепла в раздевалке', 'пол ледяной'
    ],

    'чистотой душевых': [
      'грязная плитка', 'не хватает геля', 'вода на полу', 'нет полотенец', 'плесень'
    ],
    'грязная плитка': [
      'не моют после каждой группы', 'нет чистящих средств', 'плесень в уголках', 'нет дезинфекции', 'опасно для кожи'
    ],
    'нет полотенец': [
      'забывают менять', 'только бумажные', 'нет сушилки', 'приходится покупать самому', 'грубая ткань'
    ],

    'возмущена': [
      'антисанитарией', 'хамством администратора', 'обманом в оплате', 'опасными тренажёрами', 'токсичной атмосферой'
    ],
    'антисанитарией': [
      'грязные полотенца', 'мусор в раздевалке', 'тараканы', 'грибок в душе', 'воняет'
    ],
    'грязные полотенца': [
      'не стирают по графику', 'нет маркировки', 'все в одной куче', 'запах плесени', 'один на всех'
    ],
    ‘мусор в раздевалке’: [
      ‘не выносят после занятий’, ‘нет корзин в уборных’, ‘мешки переполнены’, ‘нет уборки по заявкам’, ‘клинеры не реагируют’
    ],

    ‘хамством администратора’: [
      ‘грубые ответы’, ‘отказали без причины’, ‘разговаривают на повышенных тонах’, ‘оскорбили’, ‘не объяснили отказ’
    ],
    ‘грубые ответы’: [
      ‘перебивают на входе’, ‘игнорируют вопросы’, ‘“вам сюда нельзя”’, ‘шутят неуместно’, ‘ругаются в раздевалке’
    ],
    ‘отказали без причины’: [
      ‘не записали на тренировку’, ‘объяснений не дали’, ‘“нет мест — ищите сами”’, ‘“администратор не в курсе”’, ‘нет альтернатив’

    ],

    ‘обманом в оплате’: [
      ‘списали без предупреждения’, ‘не вернули деньги’, ‘навязали допы’, ‘скрыли штраф’, ‘обманули с акцией’
    ],
    ‘списали без предупреждения’: [
      ‘автоплатёж без согласия’, ‘смс не пришла’, ‘сняли на выходных’, ‘нет возврата при отмене’, ‘ошибка в приложении’
    ],
    ‘не вернули деньги’: [
      ‘отказали по заявке’, ‘ждать пришлось месяц’, ‘не дали подробностей’, ‘“вопрос решается” неделями’, ‘в чате не отвечают’
    ],

    ‘опасными тренажёрами’: [
      ‘сломана ручка’, ‘нет фиксатора’, ‘острые края’, ‘риск упасть’, ‘болтается весь тренажёр’
    ],
    ‘сломана ручка’: [
      ‘маленький хват’, ‘немного трещит’, ‘нет запасной’, ‘не отремонтировали за неделю’, ‘заниматься неудобно’
    ],

    ‘токсичной атмосферой’: [
      ‘соревнуются в группе’, ‘судят по внешности’, ‘игнор новичков’, ‘критика вместо обратной связи’, ‘нет поддержки’
    ],
    ‘соревнуются в группе’: [
      ‘соревнование между новичками’, ‘выделяют только “звёзд”’, ‘клиенты конфликтуют в чате’, ‘нет общей мотивации’, ‘играют на результат’
    ]
    // — завершение ветки возмущена —
    // … (предыдущие ветки выше)
    ‘нет поддержки’: [
      ‘не подошёл тренер’, ‘не помогли с программой’, ‘не заметили прогресс’, ‘отправили решать самому’, ‘сообщили “разберётесь”’
    ],
    ‘группа слишком большая’: [
      ‘занимается больше 20 человек’, ‘сложно попасть на инвентарь’, ‘нет индивидуального внимания’, ‘длинная очередь на подход’, ‘шумно и тесно’
    ],
    ‘мешают заниматься’: [
      ‘говорят слишком громко’, ‘делают фото и видео’, ‘шутят и перебивают тренера’, ‘не соблюдают режим’, ‘нет распорядка’
    ],
    ‘тайм-слот нарушен’: [
      ‘люди задерживаются’, ‘нет контроля времени’, ‘новички мешают уроку’, ‘группа затягивается’, ‘занято после вашей тренировки’
    ],

    // Замыкающая скобка блока emotions:
  },
  facts: {
    initial: [
      'опоздание тренера', 'переполненный зал', 'грязь в раздевалке',
      'неисправное оборудование', 'ошибка в абонементе', 'ошибка персонала',
      'ощущение неловкости', 'антисанитария', 'очередь на тренажёры'
    ],

    'опоздание тренера': [
      'ждала у двери', 'занятие началось позже', 'тренер не предупредил', 'без извинений', 'опоздание не впервые'
    ],
    'ждала у двери': [
      'была с группой', 'время видно на экране', 'звонили на ресепшн', 'никто не открыл вовремя', 'все нервничали'
    ],
    'была с группой': [
      'замечания несколькими клиентами', 'группа возмущалась', 'сообщили на стойку', 'дисциплина не поддерживается', 'дополнительные вопросы к администратору'
    ],

    'переполненный зал': [
      'нет мест на кардио', 'в тренажёрке очередь', 'группы объединены', 'невозможно заниматься', 'жарко и душно'
    ],
    'нет мест на кардио': [
      'ожидание больше 15 минут', 'записывались заранее, не помогло', 'человек 10 ждёт', 'нет табло доступности', 'путаются расписания'
    ],
    'ожидание больше 15 минут': [
      'пропала мотивация', 'ушёл с тренировки', 'занятие началось без меня', 'получил компенсацию отказа', 'сменил зал'
    ],

    'грязь в раздевалке': [
      'вода на полу', 'грязная плитка', 'плесень в углу', 'нет бумаги', 'мусор под скамейками'
    ],
    'вода на полу': [
      'коврики мокрые', 'скользко и опасно', 'просят убрать — игнорируют', 'жалобы в чат проходят без реакции', 'запах сырости'
    ],
    'коврики мокрые': [
      'не стираются вовремя', 'одно полотенце на всех', 'администратор знает проблему', 'уборщица приходит редко', 'ждать приходится долго'
    ],

    'неисправное оборудование': [
      'трос оборвался', 'дисплей не работает', 'поломан фиксатор', 'ржавчина на креплениях', 'скрип при нагрузке'
    ],
    'трос оборвался': [
      'на жиме', 'было опасно', 'нет замены', 'просил починить раньше', 'сервис не помогает'
    ],
    'на жиме': [
      'сразу обратился к тренеру', 'сообщил администратору', 'заменили через день', 'попросили написать жалобу', 'один занимался дома'
    ],

    'ошибка в абонементе': [
      'двойное списание', 'не активирован тариф', 'блокировка аккаунта', 'не виден период', 'не приходит подтверждение'
    ],
    'двойное списание': [
      'списали через приложение и картой', 'админ пообещал вернуть', 'завели обращение', 'нет возврата более 5 дней', 'предложили скидку на следующую оплату'
    ],
    'списали через приложение и картой': [
      'две разные суммы', 'прошёл платёж дважды', 'отоветили только в чате', 'разбирался сам', 'попросили номер карты для возврата'
    ],

    'ошибка персонала': [
      'неправильно записали время', 'ошибка при списании', 'забыли внести занятие в расписание', 'перепутали группы', 'не учли перенос'
    ],
    'неправильно записали время': [
      'новый сотрудник', 'не понял просьбу', 'клиенты ждали', 'запись удалилась', 'нет подтверждения в приложении'
    ],
    ‘забыли внести занятие в расписание’: [
      ‘нет уведомления’, ‘пропала группа’, ‘попросили написать лично’, ‘занятие не состоялось’, ‘вернули деньги’
    ],

    ‘ощущение неловкости’: [
      ‘нет шторок’, ‘все смотрят’, ‘мужчины в женской раздевалке’, ‘слишком тесно’, ‘нет отдельной зоны’
    ],
    ‘нет шторок’: [
      ‘вид из коридора’, ‘просматривалось с улицы’, ‘застеснялась переодеваться’, ‘клиенты жаловались неоднократно’, ‘админ пообещал исправить’
    ],
    ‘все смотрят’: [
      ‘комментарии новичкам’, ‘замечание не реагировали’, ‘шёпот в раздевалке’, ‘громкие обсуждения’, ‘смеялись над ошибками’
    ],

    ‘антисанитария’: [
      ‘грязные полотенца’, ‘мусор на подоконнике’, ‘таракан в душе’, ‘грязные умывальники’, ‘нет дезинфекции’
    ],
    ‘грязные полотенца’: [
      ‘сырой запах’, ‘одно полотенце на всех’, ‘не меняют уже неделю’, ‘нет маркировки’, ‘просили постирать’
    ],
    ‘таракан в душе’: [
      ‘замечен не впервые’, ‘жалобы игнорируются’, ‘клинер не отреагировал’, ‘склад рядом с душем’, ‘дрянь на стенах’
    ],

    ‘очередь на тренажёры’: [
      ‘жду на кардио больше 10 минут’, ‘нет SMS-уведомлений’, ‘таймер не срабатывает’, ‘админ не управляет очередью’, ‘все тренажёры одним списком’
    ],
    ‘жду на кардио больше 10 минут’: [
      ‘записывалась заранее’, ‘никто не выходит по времени’, ‘контроля нет’, ‘место занято чужим клиентом’, ‘понятие “по записи” не работает’
    ],
    ‘таймер не срабатывает’: [
      ‘лампочка не горит’, ‘нет экранов’, ‘никто не отслеживает’, ‘бесполезная функция’, ‘не синхронизировано с приложением’
    ]
  },
  solutions: {
    initial: [
      'таймер занятия', 'электронная очередь', 'чек-лист уборки', 'система жалоб', 'перепланировка зала',
      'замена тренера', 'тех. поддержка', 'перерасчёт абонемента', 'компенсация'
    ],

    'таймер занятия': [
      'таймер на двери', 'таймер в приложении', 'уведомление группе', 'штраф тренеру', 'фиксация участия'
    ],
    'таймер на двери': [
      'LED экран', 'обратный отсчёт', 'графика красной зоны', 'видно всем клиентам', 'автоматический старт'
    ],
    'LED экран': [
      'большой и яркий', 'размер не менее 21 дюйма', 'иконка “Занято”', 'с погодозащитой', 'установлен на видной точке'
    ],
    'обратный отсчёт': [
      'заранее начинается за 5 минут', 'эхо-звуковой сигнал', 'прогресс бар отображает минуты', 'фоновая подсветка для опоздавших', 'сброс по окончании занятия'
    ],

    'таймер в приложении': [
      'push-уведомление', 'баннер в профиле', 'история опозданий', 'интеграция с текущим расписанием', 'автоматическая компенсация участникам'
    ],
    'push-уведомление': [
      'смс за 5 минут', 'цветовое выделение', 'кнопка “я опаздываю”', 'всплывающее уведомление', 'напоминание в истории'
    ],

    'электронная очередь': [
      'слоты по 30 минут', 'предварительная запись', 'статус свободен/занят', 'уведомление о доступности', 'штраф за неявку'
    ],
    'слоты по 30 минут': [
      'блокировка при опоздании', 'автоматическое освобождение', 'пришло уведомление на почту', 'история всех заявок', 'контроль менеджера'
    ],
    'предварительная запись': [
      'за сутки через приложение', 'смс-напоминание', 'автоматический перенос свободных слотов', 'система отмены за 1 час', 'истории доступности'
    ],

    'чек-лист уборки': [
      'уборка каждые 2 часа', 'подпись уборщицы', 'фотоотчёт через приложение', 'замена грязных полотенец', 'ответственный закреплён'
    ],
    'уборка каждые 2 часа': [
      'отметка в листе проверки', 'виден график уборки клиенту', 'фиксация времени', 'смена клинера', 'проверка администратором после смены'
    ],
    'фотоотчёт через приложение': [
      'отправка фото клиенту', 'сравнение до/после', 'открытость истории уборки', 'рейтинг за чистоту', 'обновление базы красивых зон'
    ],

    'система жалоб': [
      'QR-код на стене', 'чат с админом', 'коробка для анонимных жалоб', 'онлайн-анкета', 'обратная связь за 60 мин'
    ],
    'QR-код на стене': [
      'открывает чат мгновенно', 'автоматическая ссылка на нужный зал', 'логирование клиентских обращений', 'быстрая маршрутизация вопроса', 'статус “В работе” в профиле'
    ],
    'чат с админом': [
      'возможность аудио-звонка', 'ответ без очереди', 'запись всех обращений', 'оценка работы админа', 'фотозапрос для ускорения'
    ],

    'перепланировка зала': [
      'разделение зон по цвету', 'отдельные входы для тренажёров и групповых', 'навигаторы для клиентов', 'стикеры на полу', 'открытые планы передвижения'
    ],
    ‘разделение зон по цвету’: [
      ‘понятные указатели’, ‘стикеры для детей и взрослых’, ‘отдельные прикроватные зоны’, ‘цветовой код доступа’, ‘дублируется в приложении’
    ],

    ‘замена тренера’: [
      ‘выбор другого тренера через приложение’, ‘отмена занятия без штрафа’, ‘перевод абонемента’, ‘срочный вызов замены’, ‘анкетирование клиентов о предпочтениях’
    ],
    ‘выбор другого тренера через приложение’: [
      ‘просмотр отзывов о каждом’, ‘рейтинг компетенций’, ‘свободные слоты показываются сразу’, ‘уведомление администратору’, ‘онлайн-подтверждение’
    ],

    ‘тех. поддержка’: [
      ‘кнопка вызова сервиса на тренажёре’, ‘автоматический тикет по фото’, ‘статус ремонта виден клиенту’, ‘замена неисправного в день обращения’, ‘напоминание о сервисе по расписанию’
    ],
    ‘кнопка вызова сервиса на тренажёре’: [
      ‘отправляет заявку персоналу’, ‘дублирует в чат зала’, ‘фиксирует время залипа’, ‘отвечают за 10 минут’, ‘активируется QR’
    ],

    ‘перерасчёт абонемента’: [
      ‘аннулирование начислений’, ‘расчёт компенсации бонусами’, ‘перевыпуск на другой срок’, ‘запрос подтверждения клиентом’, ‘смс при перерасчёте’
    ],
    ‘аннулирование начислений’: [
      ‘замена тарифа’, ‘автоматическая отмена оплаты’, ‘история по клиенту’, ‘отметка в балансе’, ‘отчёт клиенту’
    ],

    ‘компенсация’: [
      ‘бесплатное занятие’, ‘продление абонемента’, ‘бонусные баллы’, ‘скидка на сервис’, ‘повышение тарифа’
    ],
    ‘бесплатное занятие’: [
      ‘запись через приложение’, ‘уведомление от администратора’, ‘контроль даты’, ‘перенос без штрафа’, ‘можно подарить другому’
    ]
  }
}
  }
};

// === Текущая конфигурация ===
const currentConfig = computed(() => configs[selectedTheme.value]);
const colors = computed(() => currentConfig.value.colors);
const placeholders = computed(() => currentConfig.value.placeholders);
const examples = computed(() => currentConfig.value.examples);

// === Форма ===
const form = reactive({
  emotionalRelease: '',
  factualAnalysis: '',
  constructiveSuggestions: ''
});

// === Подсказки ===
const suggestions = reactive({ emotions: {}, facts: {}, solutions: {} });
const currentSuggestions = reactive({ emotions: [], facts: [], solutions: [] });
const selectedSuggestions = reactive({ emotions: [], facts: [], solutions: [] });
const initialFiltered = reactive({ emotions: [], facts: [], solutions: [] });
const isAtInitial = reactive({ emotions: true, facts: true, solutions: true });

// === Вопросы ===
const currentQuestion1 = ref('');
const currentQuestion2 = ref('');
const currentQuestion3 = ref('');
let rotationInterval = null;

// === Слайдер ===
const sliderLeft = computed(() => selectedTheme.value === 'cafe' ? '6px' : 'calc(50% + 6px)');

// === Сброс ===
watch(selectedTheme, () => {
  resetAll();
}, { immediate: true });

function resetAll() {
  const cfg = currentConfig.value;
  Object.keys(form).forEach(k => form[k] = '');

  Object.keys(suggestions).forEach(type => {
    suggestions[type] = { ...cfg.suggestions[type] };
    const init = cfg.suggestions[type]?.initial || [];
    initialFiltered[type] = [...init];
    currentSuggestions[type] = [...init];
    selectedSuggestions[type] = [];
    isAtInitial[type] = true;
  });

  currentQuestion1.value = cfg.questions[1][0];
  currentQuestion2.value = cfg.questions[2][0];
  currentQuestion3.value = cfg.questions[3][0];
  selectedSection.value = 'emotions';
  clearInterval(rotationInterval);
}

// === Логика подсказок ===
function showResetButton(type) {
  return !isAtInitial[type] && currentSuggestions[type].length > 0;
}

function resetSuggestions(type) {
  const filtered = initialFiltered[type].filter(word => !selectedSuggestions[type].includes(word));
  currentSuggestions[type] = filtered.length > 0 ? [...filtered] : [...initialFiltered[type]];
  isAtInitial[type] = true;
}

// === ВЫБОР ПОДСКАЗКИ: ПЕРВОЕ СЛОВО И ПОСЛЕ ТОЧКИ — ЗАГЛАВНЫЕ ===
function selectSuggestion(field, suggestion, type) {
  const text = form[field].trim();
  const isFirstWord = !text;
  const isAfterDot = text.endsWith('.');
  
  let word;
  if (isFirstWord || isAfterDot) {
    word = suggestion.charAt(0).toUpperCase() + suggestion.slice(1).toLowerCase();
  } else {
    word = suggestion.toLowerCase();
  }

  form[field] = text ? `${text} ${word}` : word;

  if (!selectedSuggestions[type].includes(suggestion)) {
    selectedSuggestions[type].push(suggestion);
  }

  isAtInitial[type] = false;
  updateSuggestions(type, suggestion);
}

// === ОБНОВЛЕНИЕ ПОДСКАЗОК: ТОЧКА В КОНЦЕ ЦЕПОЧКИ ===
function updateSuggestions(type, word) {
  const next = suggestions[type][word];
  if (next && next.length > 0) {
    currentSuggestions[type] = next.filter(item => !selectedSuggestions[type].includes(item));
  } else {
    // КОНЕЦ ЦЕПОЧКИ — СТАВИМ ТОЧКУ
    const lastField = type === 'emotions' ? 'emotionalRelease' :
                      type === 'facts' ? 'factualAnalysis' : 'constructiveSuggestions';
    const text = form[lastField].trim();
    if (text && !text.endsWith('.')) {
      form[lastField] = `${text}.`;
    }
    resetSuggestions(type);
  }
}

// === Ротация вопросов ===
function startRotation(num) {
  clearInterval(rotationInterval);
  const questions = currentConfig.value.questions[num];
  let index = 0;
  const set = (i) => {
    if (num === 1) currentQuestion1.value = questions[i];
    if (num === 2) currentQuestion2.value = questions[i];
    if (num === 3) currentQuestion3.value = questions[i];
  };
  set(index);
  rotationInterval = setInterval(() => {
    index = (index + 1) % questions.length;
    set(index);
  }, 3000);
}

onUnmounted(() => clearInterval(rotationInterval));
</script>

<style scoped>
/* РАСТЯНУТО НА ВСЮ ШИРИНУ VITEPRESS */
.signal-demo-wrapper {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  width: 100%;
  max-width: none;
  margin: 0;
  padding: 1rem 0;
}

/* Отступ между переключателями */
.signal-theme-toggle {
  margin-bottom: 1.5rem;
}

/* Tesla-style переключатель */
.signal-theme-toggle {
  position: relative;
  display: flex;
  width: 100%;
  background: #2a2a2e;
  border-radius: 16px;
  padding: 6px;
  overflow: hidden;
}
.signal-theme-btn {
  flex: 1;
  padding: 12px 16px;
  background: transparent;
  border: none;
  color: #ccc;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: color 0.3s ease;
  z-index: 2;
}
.signal-theme-btn.active {
  color: #000;
  font-weight: 700;
}
.signal-theme-slider {
  position: absolute;
  top: 6px;
  bottom: 6px;
  left: 6px;
  width: calc(50% - 12px);
  background: #fff;
  border-radius: 12px;
  transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 1;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

/* Переключатель Эмоции/Факты/Решение */
.signal-demo__header {
  display: flex;
  justify-content: center;
  margin-bottom: 1.5rem;
}
.signal-demo__switch {
  display: flex;
  gap: 8px;
  padding: 0;
  background: transparent;
  border: none;
}
.signal-demo__switch-btn {
  appearance: none;
  border: 2px solid #2c2c2f;
  background: transparent;
  color: #f0f0f0;
  padding: 8px 14px;
  border-radius: 10px;
  font-size: 0.95em;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s ease;
}
.signal-demo__switch-btn.emotions.is-active { background: rgba(169,114,255,0.14); border-color: #A972FF; color: #A972FF; }
.signal-demo__switch-btn.facts.is-active { background: rgba(61,220,132,0.14); border-color: #3DDC84; color: #3DDC84; }
.signal-demo__switch-btn.solutions.is-active { background: rgba(255,184,0,0.14); border-color: #FFB800; color: #FFB800; }

/* ГЛАВНЫЙ КОНТЕНТ */
.signal-form-content {
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.signal-question-block {
  background-color: #2a2a2e;
  border-radius: 16px;
  padding: 1.25rem;
  border: 1px solid #3a3a3e;
  border-left: 4px solid var(--accent-color);
}

.signal-direction-label {
  font-weight: 600;
  font-size: 0.75rem;
  color: #888;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 0.5rem;
}
.signal-rotating-phrase-container {
  height: 52px;
  margin-bottom: 0.75rem;
  overflow: hidden;
}
.signal-question-label {
  font-weight: 500;
  font-size: 1rem;
  margin: 0;
  color: #f0f0f0;
  line-height: 1.3;
}

textarea {
  width: 100%;
  background-color: #242426;
  border: 1px solid #444;
  border-radius: 10px;
  padding: 0.75rem 1rem;
  font-size: 0.95rem;
  color: #f0f0f0;
  transition: all 0.3s ease;
  resize: vertical;
}
textarea:focus {
  outline: none;
  border-color: var(--accent-color);
  background-color: #2a2a2e;
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent-color) 20%, transparent);
}
::placeholder { color: #666; }

.signal-suggestions-container {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin: 0.75rem 0 0.5rem;
}
.signal-suggestion-bubble {
  padding: 0.35rem 0.85rem;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  border: 1px solid transparent;
}
.signal-emotion-bubble { background: rgba(169,114,255,0.1); border-color: rgba(169,114,255,0.3); color: #A972FF; }
.signal-emotion-bubble:hover { background: #A972FF; color: #000; }
.signal-fact-bubble { background: rgba(61,220,132,0.1); border-color: rgba(61,220,132,0.3); color: #3DDC84; }
.signal-fact-bubble:hover { background: #3DDC84; color: #000; }
.signal-solution-bubble { background: rgba(255,184,0,0.1); border-color: rgba(255,184,0,0.3); color: #FFB800; }
.signal-solution-bubble:hover { background: #FFB800; color: #000; }
.signal-reset-bubble { font-weight: 600; opacity: 0.8; font-size: 0.75rem; border-style: dashed !important; }
.signal-reset-bubble:hover { opacity: 1; }

.signal-example-hint {
  font-size: 0.8rem;
  color: #777;
  margin: 0.5rem 0 0 0.25rem;
  line-height: 1.2;
}
.signal-example-hint b { color: #aaa; font-weight: 600; }

.fade-enter-active, .fade-leave-active { transition: opacity 0.5s ease; }
.fade-enter-from, .fade-leave-to { opacity: 0; }
</style>
