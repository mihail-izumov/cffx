<script setup>
import { ref } from 'vue';

const sections = [
  {
    title: 'Что измеряет аналитика Сигнала',
    content: `
<p>Аналитика Сигнала фиксирует каждый шаг: от получения обращения до закрытия и оценки опыта, превращая эту историю в понятные показатели скорости реакции, качества диалога, точности решений и удовлетворённости клиентов.</p>
<table>
<thead>
<tr><th>Направление</th><th>Что фиксируется</th><th>Зачем это нужно</th></tr>
</thead>
<tbody>
<tr><td>Скорость реакции</td><td>Время от получения обращения до отправки тикета команде</td><td>Видеть баланс скорости и качества сбора фактов</td></tr>
<tr><td>Дисциплина команды</td><td>Время от отправки тикета до ответа команды, доля соблюдения сроков</td><td>Управлять нагрузкой и дисциплиной выполнения обещаний</td></tr>
<tr><td>Качество диалога</td><td>Количество уточнений Анны, эмоциональная окраска обращений</td><td>Отслеживать тон диалогов и учить Анну точнее понимать клиентов</td></tr>
<tr><td>Типы обращений</td><td>Компенсируемые, системные, категории приоритета</td><td>Находить повторяющиеся проблемы и вкладывать ресурсы туда, где отдача максимальна</td></tr>
<tr><td>Доставка решений</td><td>Доля тикетов с реальными изменениями, с компенсацией, с альтернативой</td><td>Оценивать, сколько ситуаций решается системно, а сколько «гасится» сертификатами</td></tr>
<tr><td>Удовлетворённость клиентов</td><td>Оценки опыта после закрытия, повторные обращения по той же теме</td><td>Видеть, довольны ли клиенты результатом, а не только фактом ответа</td></tr>
</tbody>
</table>
    `
  },
  {
    title: 'Ключевые метрики',
    content: `
<table>
<thead>
<tr><th>Метрика</th><th>Норматив</th><th>Практический смысл</th></tr>
</thead>
<tbody>
<tr><td>Время «обращение → тикет»</td><td>≤ 15 минут</td><td>Показывает, как быстро Анна собрала факты и передала задачу команде, без затягивания переписки</td></tr>
<tr><td>Доля превышений окна 15 минут</td><td>≤ 10%</td><td>Оценивает дисциплину: держится ли команда в окне баланса или часто откладывает задачи</td></tr>
<tr><td>Время «тикет → ответ команды»</td><td>По категории А–Г</td><td>Контролирует соблюдение обещанных сроков ответа по приоритету</td></tr>
<tr><td>Доля просрочек ответа</td><td>≤ 5%</td><td>Выявляет системные проблемы: нагрузка, недооценка времени или сбои в процессе</td></tr>
<tr><td>Среднее количество версий тикета</td><td>≤ 2</td><td>Показывает, насколько чётко собраны факты с первого раза</td></tr>
<tr><td>Доля тикетов без диалога</td><td>Динамический</td><td>Баланс: если высокая — возможно мало уточнений; если низкая — команда держит контроль</td></tr>
<tr><td>Доля реальных изменений vs компенсаций</td><td>≥ 60% системных</td><td>Показывает, устраняете ли причины или «покупаете лояльность»</td></tr>
<tr><td>Средняя оценка опыта (NPS)</td><td>≥ 8 из 10</td><td>Честная картина удовлетворённости после решения, а не только факта ответа</td></tr>
<tr><td>Доля повторных обращений</td><td>≤ 3%</td><td>Оценивает качество решения: если высокая — решения не устраняют корень</td></tr>
</tbody>
</table>
    `
  },
  {
    title: 'Ежедневная аналитика',
    content: `
<p>Ежедневный контроль помогает быстро реагировать на текущие узкие места, держать команду в тонусе и не пропускать критичные отклонения по скорости или качеству.</p>
<table>
<thead>
<tr><th>Ритуал</th><th>Что смотреть</th><th>Что делать с этим</th></tr>
</thead>
<tbody>
<tr><td>Утренний обзор тикетов</td><td>Сколько новых обращений за сутки, сколько в работе, сколько просрочено</td><td>Распределить приоритеты дня и усилить внимание к просрочкам</td></tr>
<tr><td>Контроль окна 15 минут</td><td>Сколько тикетов превысили окно вчера, в среднем какое время сбора фактов</td><td>Обсудить с оператором причины задержек и скорректировать подход диалогов</td></tr>
<tr><td>Просмотр эмоциональной окраски</td><td>Сколько клиентов пришло спокойными, разочарованными, возмущёнными</td><td>Прогнозировать тон ответов команды и усиливать внимание к «горячим»</td></tr>
<tr><td>Проверка дедлайнов на сегодня</td><td>Сколько тикетов требуют ответа до конца дня</td><td>Напомнить команде о конкретных задачах и не допустить просрочек</td></tr>
<tr><td>Финальный обзор вечером</td><td>Все ли ответы отправлены, все ли дедлайны соблюдены, какие тикеты переходят в завтра</td><td>Зафиксировать итоги дня и подготовить приоритеты на утро</td></tr>
</tbody>
</table>
    `
  },
  {
    title: 'Еженедельная аналитика',
    content: `
<p>Еженедельная ретроспектива выявляет тренды: где процессы стабильны, где растут задержки, какие типы обращений повторяются и что улучшить системно за короткий горизонт.</p>
<table>
<thead>
<tr><th>Ритуал</th><th>Что анализировать</th><th>Что делать с этим</th></tr>
</thead>
<tbody>
<tr><td>Обзор среднего времени реакции</td><td>Среднее «обращение → тикет» и «тикет → ответ» за неделю</td><td>Сравнить с нормативом и предыдущими неделями: улучшается или ухудшается скорость</td></tr>
<tr><td>Анализ превышений 15 минут</td><td>Какие тикеты превысили окно и почему: молчание клиента, долгие уточнения, забывчивость</td><td>Выделить паттерны и скорректировать инструкции для Анны или оператора</td></tr>
<tr><td>Распределение по категориям А–Г</td><td>Сколько каждой категории, какие темы доминируют</td><td>Найти повторяющиеся проблемы: если много Б по одной теме — время системного исправления</td></tr>
<tr><td>Соотношение компенсируемых и системных</td><td>Сколько решили компенсацией, сколько реальными изменениями</td><td>Оценить, не «замазываете» ли проблемы сертификатами вместо устранения причин</td></tr>
<tr><td>Сводка по доставке решений</td><td>Сколько тикетов закрыто «изменения внесены», сколько «альтернатива», сколько «разовая ошибка»</td><td>Видеть, сколько ситуаций решается навсегда, а сколько остаётся на паллиативе</td></tr>
<tr><td>Обзор оценок опыта</td><td>Средний NPS за неделю, какие тикеты получили низкие оценки и почему</td><td>Выявить слабые точки в доставке решения: где клиент недоволен даже после ответа</td></tr>
<tr><td>План улучшений на следующую неделю</td><td>Один конкретный фокус: ускорить сбор фактов, сократить просрочки, улучшить тон ответов</td><td>Превратить данные в действие: одна измеримая цель на неделю</td></tr>
</tbody>
</table>
    `
  },
  {
    title: 'Ежемесячная аналитика',
    content: `
<p>Ежемесячный анализ — это стратегический взгляд: куда движется качество обслуживания, какие системные сбои нужно исправлять, как растёт команда и что стоит автоматизировать или изменить в процессах.</p>
<table>
<thead>
<tr><th>Ритуал</th><th>Что анализировать</th><th>Что делать с этим</th></tr>
</thead>
<tbody>
<tr><td>Динамика скорости за 3 месяца</td><td>Тренд среднего времени «обращение → тикет → ответ»</td><td>Оценить, растёт ли скорость реакции или стагнирует, и найти причины застоя</td></tr>
<tr><td>Топ‑5 повторяющихся проблем</td><td>Какие темы обращений пришли чаще всего за месяц</td><td>Запустить системные улучшения: обучение команды, изменения в операциях, коммуникация с клиентами</td></tr>
<tr><td>Эффективность компенсаций</td><td>Какие номиналы сертификатов выдавались, как часто, снизилось ли количество повторов по той же теме</td><td>Проверить, решают ли компенсации проблему лояльности или нужны реальные изменения</td></tr>
<tr><td>Анализ повторных обращений</td><td>Сколько клиентов написало второй раз по той же ситуации</td><td>Выявить недорешённые проблемы и усилить контроль качества закрытия тикетов</td></tr>
<tr><td>Удовлетворённость по категориям</td><td>Средний NPS по категориям А, Б, В, Г</td><td>Понять, где клиенты довольны результатом, а где даже быстрый ответ не спасает от низкой оценки</td></tr>
<tr><td>Нагрузка на команду</td><td>Сколько тикетов в месяц на одного члена команды, какие пики нагрузки</td><td>Планировать расширение команды или перераспределение ролей при росте обращений</td></tr>
<tr><td>Аудит качества диалогов Анны</td><td>Примеры лучших и худших диалогов, где Анна промахнулась с тоном или вопросами</td><td>Обучить Анну на реальных кейсах: что работает, что отталкивает, где нужна коррекция</td></tr>
<tr><td>Стратегические улучшения</td><td>Одно крупное изменение в процессах или системе на следующий квартал</td><td>Превратить месяц данных в решение: автоматизация, новый протокол, изменение нормативов</td></tr>
</tbody>
</table>
    `
  },
  {
    title: 'Синхронизация с Анной и тикет‑системой',
    content: `
<p>Тикет‑система автоматически собирает временные метки каждого шага, Анна фиксирует эмоциональную окраску и тип обращения, а аналитика превращает эти данные в отчёты без ручного ввода или угадываний.</p>
<table>
<thead>
<tr><th>Этап</th><th>Что фиксирует тикет‑система</th><th>Что добавляет Анна</th><th>Что считает аналитика</th></tr>
</thead>
<tbody>
<tr>
<td>Получение обращения</td>
<td>Время «Submitted», присвоение номера</td>
<td>Первое сообщение клиенту с приветствием и вопросами</td>
<td>Количество новых обращений в час/день/неделю</td>
</tr>
<tr>
<td>Сбор фактов</td>
<td>Время диалогов, количество сообщений</td>
<td>Эмоциональная окраска, тип и категория обращения</td>
<td>Среднее время диалога, доля спокойных/возмущённых, распределение по категориям</td>
</tr>
<tr>
<td>Формирование тикета</td>
<td>«Время создания тикета», статус «Отправлено команде»</td>
<td>Рекомендации к действию, история переписки</td>
<td>Время «обращение → тикет», доля превышений 15 минут, среднее количество версий</td>
</tr>
<tr>
<td>Ожидание ответа</td>
<td>Дедлайн, время до дедлайна, уведомления команде</td>
<td>—</td>
<td>Количество напоминаний, доля просрочек, среднее время ответа команды</td>
</tr>
<tr>
<td>Фиксация ответа</td>
<td>«Время ответа команды», подтверждение «Ответ получен»</td>
<td>—</td>
<td>Скорость реакции команды по категориям, распределение ответов по срокам</td>
</tr>
<tr>
<td>Доставка решения</td>
<td>Тип решения: изменения/компенсация/альтернатива</td>
<td>Текст итога для клиента понятным языком</td>
<td>Доля каждого типа решения, соотношение системных и компенсируемых</td>
</tr>
<tr>
<td>Оценка опыта</td>
<td>Дата запроса оценки, время ожидания оценки</td>
<td>Короткая просьба оценить опыт после результата</td>
<td>Средний NPS, доля высоких/низких оценок, корреляция с типами решений</td>
</tr>
<tr>
<td>Закрытие</td>
<td>Статус «Завершён», дата архивации</td>
<td>Благодарность за вклад в улучшения</td>
<td>Общее время жизни тикета, доля повторных обращений</td>
</tr>
</tbody>
</table>
    `
  },
  {
    title: 'Отчёты по запросу',
    content: `
<p>Аналитика Сигнала предоставляет детализированные отчёты по запросу для глубокого анализа конкретных периодов, тем или ситуаций. Регулярность подготовки сводных отчётов — раз в 2 недели с динамикой метрик, предложениями по улучшению процессов и выводами о тренде качества работы.</p>
<table>
<thead>
<tr><th>Отчёт</th><th>Что показывает</th><th>Когда запрашивать</th></tr>
</thead>
<tbody>
<tr>
<td>Сегодня</td>
<td>Новые тикеты, дедлайны на сегодня, просрочки, превышения 15 минут</td>
<td>Утром и вечером каждого рабочего дня</td>
</tr>
<tr>
<td>Эта неделя</td>
<td>Среднее время реакции, распределение по категориям, соотношение решений, средний NPS</td>
<td>Понедельник утром для планирования недели</td>
</tr>
<tr>
<td>Этот месяц</td>
<td>Динамика скорости, топ‑5 проблем, нагрузка на команду, тренды удовлетворённости</td>
<td>Первые дни месяца для стратегических решений</td>
</tr>
<tr>
<td>Команда</td>
<td>Нагрузка по исполнителям, средняя скорость каждого, доля просрочек</td>
<td>Еженедельно для балансировки нагрузки</td>
</tr>
</tbody>
</table>
    `
  },
  {
    title: 'Глубокий разбор при отклонениях',
    content: `
<p>При значимых отклонениях — резкое увеличение просрочек, повторяющиеся жалобы на одну тему, аномально долгое время ответа — проводится детальный разбор каждого проблемного тикета с полной историей: что писал клиент, как отвечала Анна, когда оператор отправил тикет, как и когда команда ответила. Цель — не найти виноватого, а улучшить процесс на всех уровнях: система, оператор, команда. На основе разбора даются конкретные рекомендации: добавить вторую смену для проверки чатов, настроить дублирующие уведомления, изменить процесс обработки определённого типа жалоб, чтобы клиенты получали ответы быстрее и качественнее.</p>
    `
  },
  {
    title: 'Возможности аналитики Сигнала',
    content: `
<p>Это готовая инфраструктура глубокого контроля качества обслуживания клиентов, которая превращает каждый тикет в данные для управления скоростью, точностью и удовлетворённостью без ручного сбора и угадываний.</p>
<table>
<thead>
<tr>
<th>Элемент</th>
<th>Что это</th>
<th>Что даёт команде</th>
<th>Что даёт бизнесу</th>
</tr>
</thead>
<tbody>
<tr>
<td>Автоматический сбор метрик</td>
<td>Временные метки каждого шага от обращения до закрытия</td>
<td>Нет ручного ввода, нет искажений, честная картина скорости</td>
<td>Реальные данные для управления качеством, а не ощущения</td>
</tr>
<tr>
<td>Контроль окна 15 минут</td>
<td>Показатель баланса качества и скорости сбора фактов</td>
<td>Видит, где затягивается переписка, где нужна коррекция</td>
<td>Быстрее запуск работ без потери полноты информации</td>
</tr>
<tr>
<td>Дисциплина дедлайнов</td>
<td>Доля соблюдения сроков ответа по категориям</td>
<td>Прозрачность выполнения обещаний и узких мест</td>
<td>Честные ожидания клиентов и предсказуемость реакции</td>
</tr>
<tr>
<td>Типология обращений</td>
<td>Распределение по категориям и темам</td>
<td>Видит повторяющиеся проблемы для системных улучшений</td>
<td>Инвестирует ресурсы туда, где максимальная отдача</td>
</tr>
<tr>
<td>Соотношение решений</td>
<td>Доля системных изменений vs компенсаций</td>
<td>Оценивает, устраняют ли причины или «гасят» сертификатами</td>
<td>Снижает количество повторных обращений и укрепляет лояльность</td>
</tr>
<tr>
<td>Удовлетворённость клиентов</td>
<td>Средний NPS и корреляция с типами решений</td>
<td>Видит, довольны ли клиенты результатом, а не только ответом</td>
<td>Управляет репутацией и предотвращает негативные отзывы</td>
</tr>
<tr>
<td>Ежедневные ритуалы</td>
<td>Утренний и вечерний обзор приоритетов</td>
<td>Держит команду в тонусе и не пропускает критичные отклонения</td>
<td>Быстрая реакция на текущие проблемы без задержек</td>
</tr>
<tr>
<td>Еженедельные ретроспективы</td>
<td>Тренды скорости, качества, повторяющихся проблем</td>
<td>Выявляет паттерны за короткий горизонт и корректирует процессы</td>
<td>Непрерывное улучшение без застоя</td>
</tr>
<tr>
<td>Ежемесячный стратегический обзор</td>
<td>Динамика за 3 месяца, топ‑5 проблем, нагрузка, системные улучшения</td>
<td>Стратегические решения: автоматизация, расширение команды, обучение</td>
<td>Рост качества обслуживания и масштабирование без хаоса</td>
</tr>
<tr>
<td>Синхронизация Анна + Тикет + Аналитика</td>
<td>Единый поток данных без разрывов</td>
<td>Не нужно вручную сводить отчёты из разных систем</td>
<td>Полная прозрачность пути клиента от обращения до результата</td>
</tr>
<tr>
<td>Глубокий разбор при отклонениях</td>
<td>Детальный анализ проблемных тикетов с историей и рекомендациями</td>
<td>Понимает, где именно произошёл сбой: Анна, оператор, команда или нагрузка</td>
<td>Непрерывное улучшение процессов без повторения ошибок</td>
</tr>
</tbody>
</table>
<p>Аналитика Сигнала — это не просто «отчёты», а умная система управления качеством обслуживания клиентов через данные: вы видите скорость реакции, точность решений, удовлетворённость клиентов и узкие места в процессах, чтобы каждый день улучшать результат и доставлять лучший опыт без угадываний и надежды на лучшее.</p>
    `
  }
];

const detailsRefs = ref([]);
const handleToggle = (index) => {
  const currentDetails = detailsRefs.value[index];
  if (currentDetails && currentDetails.open) {
    detailsRefs.value.forEach((details, i) => {
      if (i !== index && details && details.open) {
        details.open = false;
      }
    });
  }
};
</script>

<template>
  <div class="analytics-accordion-wrapper">
    <details 
      v-for="(section, index) in sections" 
      :key="index" 
      class="analytics-instruction-block"
      :ref="el => { if (el) detailsRefs[index] = el }"
      @toggle="handleToggle(index)"
    >
      <summary class="analytics-summary">
        <h3 class="analytics-title">{{ section.title }}</h3>
        <span class="analytics-arrow">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="m6 9 6 6 6-6"/>
          </svg>
        </span>
      </summary>
      <div class="analytics-content" v-html="section.content"></div>
    </details>
  </div>
</template>

<style scoped>
.analytics-accordion-wrapper {
  max-width: 1200px !important;
  margin: 0 auto !important;
  padding: 0 !important;
}

.analytics-instruction-block {
  background: rgba(255, 255, 255, 0.03) !important;
  border: none !important;
  border-radius: 12px !important;
  margin-bottom: 12px !important;
  overflow: hidden !important;
  box-shadow: none !important;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

.analytics-summary {
  display: flex !important;
  align-items: center !important;
  justify-content: space-between !important;
  padding: 16px 24px !important;
  cursor: pointer !important;
  list-style: none !important;
  user-select: none !important;
  background: transparent !important;
  border: none !important;
  margin: 0 !important;
  transition: none !important;
}

.analytics-summary::-webkit-details-marker,
.analytics-summary::marker,
.analytics-summary::before,
.analytics-summary::after {
  display: none !important;
  content: '' !important;
  width: 0 !important;
  height: 0 !important;
}

.analytics-instruction-block::-webkit-details-marker,
.analytics-instruction-block::marker,
.analytics-instruction-block::before,
.analytics-instruction-block::after {
  display: none !important;
  content: '' !important;
}

.analytics-summary > *:not(.analytics-title):not(.analytics-arrow) {
  display: none !important;
}

.analytics-title {
  margin: 0 !important;
  padding: 0 !important;
  font-size: 18px !important;
  font-weight: 600 !important;
  color: #ffffff !important;
  border: none !important;
  line-height: 1.4 !important;
}

.analytics-title::before,
.analytics-title::after {
  display: none !important;
  content: '' !important;
}

.analytics-arrow {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  flex-shrink: 0 !important;
  margin-left: 16px !important;
  transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
  color: #9ca3af !important;
}

.analytics-arrow svg {
  display: block !important;
  width: 20px !important;
  height: 20px !important;
}

.analytics-instruction-block[open] .analytics-arrow {
  transform: rotate(180deg) !important;
}

.analytics-content {
  padding: 0 24px 20px !important;
  color: #ffffff !important;
  line-height: 1.7 !important;
  background: transparent !important;
  border: none !important;
  animation: slideDown 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.analytics-content :deep(p) {
  margin: 0 0 16px !important;
  color: #ffffff !important;
}

.analytics-content :deep(table) {
  width: 100% !important;
  border-collapse: collapse !important;
  margin: 16px 0 !important;
  font-size: 14px !important;
  background: transparent !important;
}

.analytics-content :deep(th) {
  background: rgba(100, 100, 100, 0.15) !important;
  padding: 12px !important;
  text-align: left !important;
  font-weight: 600 !important;
  border: 1px solid rgba(120, 120, 120, 0.2) !important;
  color: #ffffff !important;
}

.analytics-content :deep(td) {
  padding: 12px !important;
  border: 1px solid rgba(100, 100, 100, 0.15) !important;
  color: #ffffff !important;
  background: transparent !important;
}

.analytics-content :deep(tr:hover) {
  background: rgba(100, 100, 100, 0.08) !important;
}
</style>
